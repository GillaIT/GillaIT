<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
</head>
<body>
<div>
    <table>
        <thead>
        <tr>
            <th>id</th>
            <th>이메일</th>
            <th>동아리이름</th>
            <th>활성화/비활성화</th>
            <th>삭제</th>
        </tr>
        </thead>
        <tbody>
        <tr th:each="user: ${users}">
            <td th:text="${user.id}"></td>
            <td th:text="${user.email}"></td>
            <td th:text="${user.group_name}"></td>
            <td>
                <button onclick="toggleActive(${user.id}, ${user.isActive})">
                    <span id="toggleText_${user.id}"></span>
                </button>
            </td>
            <td>
                <button onclick="deleteUser(${user.id})">삭제</button>
            </td>
        </tr>
        </tbody>
    </table>
</div>

<script>
    // PUT 요청을 시뮬레이트하는 함수
    function toggleActive(userId, isActive) {
        // 서버로 전송할 데이터
        var data = { userId: userId };

        // PUT 요청 시뮬레이션
        fetch('/admin/user/toggle', {
            method: 'PUT',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify(data)
        })
            .then(response => {
                // 응답 처리
                console.log('활성화/비활성화 요청이 완료되었습니다.');

                // 버튼 텍스트 변경
                var button = document.getElementById(`toggleText_${userId}`);
                if (isActive) {
                    button.innerText = '활성화';
                } else {
                    button.innerText = '비활성화';
                }
            })
            .catch(error => {
                // 오류 처리
                console.error('오류 발생:', error);
            });
    }

    // DELETE 요청을 시뮬레이트하는 함수
    function deleteUser(userId) {
        // 서버로 전송할 데이터
        const data = { userId: userId };

        // DELETE 요청 시뮬레이션
        fetch('/admin/user', {
            method: 'DELETE',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify(data)
        })
            .then(response => {
                // 응답 처리
                console.log('삭제 요청이 완료되었습니다.');
            })
            .catch(error => {
                // 오류 처리
                console.error('오류 발생:', error);
            });
    }
</script>
</body>
</html>
